<!DOCTYPE html>
<html>
    <head>
        <title>JSON test</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script>
            let counter = 1;
            function parodyk() {

                fetch("/zmones_w10jpa/ws/zmogus", {
                    method: "GET",
                    headers: {
                        "Accept": "application/json"
                    }
                })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    const app = document.getElementById("app");
                    cleanElement(app);
                    app.appendChild(document.createTextNode(counter++));
                    const table = document.createElement("table");
                    app.appendChild(table);
                    const tbody = document.createElement("tbody");
                    table.appendChild(tbody);
                    for (const z of data) {
                        const tr = document.createElement("tr");
                        tbody.appendChild(tr);
                        for (const prop in z) {
                            const td = document.createElement("td");
                            tr.appendChild(td);
                            const text = document.createTextNode(z[prop]);
                            td.appendChild(text);
                        }
                    }
                });
                
//                let str;
//                str = `
//[
//        {
//                "id": 1,
//                "vardas": "Jonas",
//                "pavarde": "Jonaitis",
//                "gimimoData": "1992-02-03",
//                "alga": 651.158
//        },
//        {
//                "id": 2,
//                "vardas": "Petras",
//                "pavarde": "Petraitis",
//                "gimimoData": "1993-04-05",
//                "alga": 4151
//        }
//]`;
//                str = document.getElementById("tekstas").value;
//                console.log("Tekstas: ", str);
//                let duomenys = JSON.parse(str);
//                console.log("Duomenys: ", duomenys);
            }

            function cleanElement(el) {
                if (el) {
                    while (el.firstChild) {
                        el.removeChild(el.firstChild);
                    }
                }
            }

            function pridek() {
                counter++;
                const z = {
                    vardas: "vardasIsJS" + counter,
                    pavarde: "pavardeIsJS" + counter,
                    gimimoData: "1985-11-07",
                    alga: 154.12
                };
                fetch("/zmones_w10jpa/ws/zmogus", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(z, null, 16)
                });


            }
        </script>
    </head>
    <body>
        <input type="text" id="tekstas">
        <button onclick="parodyk();">Parodyk</button>
        <button onclick="pridek();">Pridek</button>
        <div id="app"></div>
    </body>
</html>
